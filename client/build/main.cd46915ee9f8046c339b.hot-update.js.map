{"version":3,"file":"main.cd46915ee9f8046c339b.hot-update.js","sources":["webpack:///src/server.js"],"sourcesContent":["import App from './App'\nimport React from 'react'\nimport { StaticRouter } from 'react-router-dom'\nimport Koa from 'koa'\nimport serve from 'koa-static'\nimport helmet from 'koa-helmet'\nimport Router from 'koa-router'\nimport { renderToString } from 'react-dom/server'\n\nconst assets = require(process.env.RAZZLE_ASSETS_MANIFEST)\n\nconst router = new Router()\nrouter.get(\n  '/*',\n  (ctx, next) => {\n    const context = {}\n    const markup = renderStylesToString(\n      renderToString(\n        <StaticRouter context={context} location={ctx.url}>\n          <App />\n        </StaticRouter>,\n      ),\n    )\n    ctx.state.markup = markup\n    return context.url ? ctx.redirect(context.url) : next()\n  },\n  ctx => {\n    ctx.status = 200\n    ctx.body = `\n    <!doctype html>\n      <html lang=\"\">\n      <head>\n          <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n          <meta charset=\"utf-8\" />\n          <title>Welcome to Razzle + Koa</title>\n          <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n          ${\n            assets.client.css\n              ? `<link rel=\"stylesheet\" href=\"${assets.client.css}\">`\n              : ''\n          }\n          ${\n            process.env.NODE_ENV === 'production'\n              ? `<script src=\"${assets.client.js}\" defer></script>`\n              : `<script src=\"${assets.client.js}\" defer crossorigin></script>`\n          }\n      </head>\n      <body>\n          <div id=\"root\">${ctx.state.markup}</div>\n      </body>\n    </html>`\n  },\n)\n\nconst server = new Koa()\nserver\n  .use(helmet())\n  .use(serve(process.env.RAZZLE_PUBLIC_DIR))\n  .use(router.routes())\n  .use(router.allowedMethods())\n\nexport default server\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AACA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAKA;AACA;AACA;AAEA;AACA;AAuBA;AACA;AAEA;AACA;AACA;AAKA;;;;A","sourceRoot":""}